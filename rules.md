# 入侵检测规则提取

## 1. 最优模型选择

**选定模型**: t-SNE-2D + SVM (RBF核)

**选择理由**：
1. **准确率最高**: 76.05%（所有15组实验中最佳）
2. **误报率极低**: 仅1.03%，减少正常流量误拦截
3. **攻击检测精确**: Precision 86.99%，检测到的攻击87%为真实攻击
4. **适用场景**: 适合对误报敏感的环境（如企业网络），可容忍部分攻击漏检但不能频繁误报

## 2. 模型参数配置

```python
# 降维配置
reducer = TSNE(
    n_components=2,
    perplexity=30,
    learning_rate='auto',
    max_iter=1000,
    init='pca',
    random_state=42
)

# 分类器配置
classifier = SVC(
    C=10,
    kernel='rbf',
    gamma='scale',
    random_state=42
)
```

## 3. 检测规则说明

**工作流程**：
1. 对输入流量特征进行Min-Max归一化
2. 使用t-SNE降维至2维空间
3. 使用SVM分类器判断（Benign vs Infilteration）
4. 输出检测结果及置信度

**性能特点**：
- **低误报**: FPR=1.03%，每100个正常流量仅误报1个
- **高漏报**: FNR=82.45%，约82%的攻击会被漏检
- **高精确度**: Precision=86.99%，检测为攻击时87%正确

## 4. 部署建议

**适用场景**：
- 企业内网监控（不能频繁误报影响业务）
- 作为多层防御的一层（配合其他高召回率系统）
- 需要低误报的实时监控场景

**优化方向**：
- 增加训练样本量提升召回率
- 集成多个模型（高精确率+高召回率）
- 针对不同攻击类型调整阈值

## 5. Infilteration 攻击特征

基于t-SNE降维后的2D空间：
- 攻击流量在降维空间中形成较分散的分布
- SVM决策边界能有效分离大部分正常流量
- 少量攻击流量与正常流量混叠导致漏报

**建议**：结合规则引擎，对SVM不确定的样本进行二次检测
